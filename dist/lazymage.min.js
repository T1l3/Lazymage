angular.module("lazymage",[]),angular.module("lazymage").provider("lazymageRemote",function(){"use strict";var a=this;this.globalOptions={};var b={currentImage:{attrs:{}},errorImage:{src:null,attrs:{}},defaultImage:{src:null,attrs:{}},loader:{html:'<span class="lazymage-loader">Preloading...</span>'}};return this.$get=[function(){var c={};return angular.extend(b,a.globalOptions),c.globalOptions=b,c}],this}).directive("lazymage",["lazymageRemote",function(a){"use strict";return{restrict:"A",link:function(b,c,d){c.addClass("lazymage-container");var e={};angular.extend(e,a.globalOptions),angular.isDefined(d.lazymageOptions)&&d.lazymageOptions&&angular.extend(e,b.$eval(d.lazymageOptions));var f=["defaultImage","loader"];angular.forEach(f,function(a){(void 0===e[a].removeTimeout||null===e[a].removeTimeout)&&(e[a].removeTimeout=0)});var g=d.lazymage,h=function(a,b){void 0===b&&(b={}),a.attr(b),setTimeout(function(){c.append(a)},0)},i=function(){k&&e.defaultImage.removeTimeout!==!1&&setTimeout(function(){k.remove()},e.defaultImage.removeTimeout),l&&e.loader.removeTimeout!==!1&&setTimeout(function(){l.remove()},e.loader.removeTimeout)};if((e.defaultImage.src||e.loader.html)&&c.html(""),e.defaultImage.src){var j=new Image;j.src=e.defaultImage.src;var k=jQuery(j);h(k,e.defaultImage.attrs)}if(e.loader.html){var l=jQuery(e.loader.html);c.append(l)}var m=new Image;m.onload=function(){c.addClass("lazymage-loaded"),h(jQuery(m),e.currentImage.attrs),i()},m.onerror=function(){c.addClass("lazymage-error"),e.errorImage.src&&(m.src=e.errorImage.src,h(jQuery(m),e.errorImage.attrs)),i()},m.src=g}}}]);